{% extends "/layout.html" %}

{% block styles %}
<link href="/static/css/cartodb-gmapsv3.css" rel="stylesheet" type="text/css" />
<link  href="http://code.google.com/apis/maps/documentation/javascript/examples/default.css" rel="stylesheet" type="text/css" />
{% endblock %}

{% block body %}

<div id="content" class="cf interior">

	
	<div class="content-wrap" id="mapFrameContainer">
		<div id="text-block" >
			<select id="map_selection">

			</select>
			

		</div>

		


		<div id="map" style="width:100%;height:350px;"></div>

	</div>
</div>
{% endblock %}


{% block scripts %}
<script src="http://maps.googleapis.com/maps/api/js?sensor=false&libraries=drawing" type="text/javascript"></script>
<script type="text/javascript" src="/static/js/libs/wax.g.min-6.2.0-touched.js"></script>
<script type="text/javascript" src="/static/js/libs/cartodb-gmapsv3-min.js"></script>



<script type="text/javascript">
   

	var cartoQueries = {};

	cartoQueries.cycling_friendly_yes = {
		label : "Cycle friendly streets",
		query : "SELECT * FROM dynamicconnections where is_the_gradient_amenable_to_cycling='yes'"
	};
	cartoQueries.cycling_friendly_no = "SELECT * FROM dynamicconnections where is_the_gradient_amenable_to_cycling='no'";
	cartoQueries.good_access = "SELECT * FROM dynamicconnections where link_to_destinations='yes'";
	cartoQueries.safe_intersections = "SELECT * FROM dynamicconnections where street_offers_priority_through_intersections='yes'";
	cartoQueries.happy_streets = "SELECT * FROM dynamicconnections where how_do_you_feel='happy'";


	var cartodb_gmapsv3, map;
	jQuery(document).ready(function(){
		map = new google.maps.Map(document.getElementById('map'), {
		  center: new google.maps.LatLng(52.532408, 13.41152),
		  zoom: 3,
		  mapTypeId: google.maps.MapTypeId.ROADMAP,
		  mapTypeControl: false
		});

		cartodb_gmapsv3 = new CartoDBLayer({
		  map: map,
		  user_name:'johnschimmel',
		  table_name: 'dynamicconnections_live',
		  query: "SELECT * FROM dynamicconnections_live",
		  layer_order: "top",
		  tile_style: "#dynamicconnections_live{line-color:red}",
		  interactivity: "cartodb_id, magnitude",
		  featureClick: function(ev, latlng, pos, data) {alert(data.cartodb_id)},
		  featureOver: function(ev, latlng, pos, data) {},
		  featureOut: function() {},
		  auto_bound: true
		});

	})


/*
 var overlay, cartodb_imagemaptype,
      carto_map = null,
  cat = 'II',
      lat = 52.532408,
      lng = 13.41152;

    var resetLayer = function(){
      // Add the cartodb tiles
      cartodb_imagemaptype = new google.maps.ImageMapType(cartodb_layer);
      carto_map.overlayMapTypes.insertAt(0, cartodb_imagemaptype);
      carto_map.overlayMapTypes.pop(1);
    }

    var cartodb_layer = {
      getTileUrl: function(coord, zoom) {
        var baseURL = "https://johnschimmel.cartodb.com/tiles/dynamicconnections_live/"+zoom+"/"+coord.x+"/"+coord.y+".png";
        baseURL += "&sql=SELECT * FROM dynamicconnections_live";
        baseURL += "&style=%23dynamicconnections_live { line-color:%23FF6600;line-width:5;line-opacity:0.34;}";
        //console.log(baseURL);
        return baseURL;
      },
        tileSize: new google.maps.Size(256, 256)
    }

    jQuery(document).ready(function(){

        //Basic
          var cartodbMapOptions = {
            zoom: 12,
            center: new google.maps.LatLng( lat, lng ),
            disableDefaultUI: true,
            mapTypeId: google.maps.MapTypeId.ROADMAP
          }

          // Init the map
          carto_map = new google.maps.Map(document.getElementById("map"),cartodbMapOptions);

        map_style = [ { stylers: [ { saturation: -65 }, { gamma: 1.52 } ] }, { featureType: "administrative", stylers: [ { saturation: -95 },{ gamma: 2.26 } ] }, { featureType: "water", elementType: "labels", stylers: [ { visibility: "off" } ] }, { featureType: "administrative.locality", stylers: [ { visibility: 'on' } ] }, { featureType: "road", stylers: [ { visibility: "simplified" }, { saturation: -99 }, { gamma: 2.22 } ] }, { featureType: "poi", elementType: "labels", stylers: [ { visibility: "off" } ] }, { featureType: "road.arterial", stylers: [ { visibility: 'on' } ] }, { featureType: "road.local", elementType: "labels", stylers: [ { visibility: 'on' } ] }, { featureType: "transit", stylers: [ { visibility: 'off' } ] }, { featureType: "road", elementType: "labels", stylers: [ { visibility: 'on' } ] },{ featureType: "poi", stylers: [ { saturation: -55 } ] } ];

        carto_map.setOptions({styles: map_style});

          // Add the cartodb tiles
          cartodb_imagemaptype = new google.maps.ImageMapType(cartodb_layer);
          carto_map.overlayMapTypes.insertAt(0, cartodb_imagemaptype);

	    jQuery('.buttons button').click(function(){
	      jQuery(this).focus();
	      cat = jQuery(this).val();
	      jQuery(this).closest('div').find('button.selected').removeClass('selected');
	      jQuery(this).addClass('selected');
	      resetLayer();
	    });
    });

*/
</script>


{% endblock %}