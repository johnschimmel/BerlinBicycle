{% extends "/layout.html" %}

{% block styles %}{% endblock %}

{% block body %}
<div id="content" class="cf interior">

	
	<div class="content-wrap" id="mapFrameContainer">
		<div id="text-block" >
			<select id="map_selection">

			</select>
			

		</div>

		


		<div id="map" style="width:100%;height:350px;"></div>

	</div>
</div>
{% endblock %}


{% block scripts %}
<script src="http://maps.googleapis.com/maps/api/js?sensor=false&libraries=drawing" type="text/javascript"></script>


<script type="text/javascript">
    var overlay, cartodb_imagemaptype,
      carto_map = null,
  cat = 'II',
      lat = 52.532408,
      lng = 13.41152;

    var resetLayer = function(){
      // Add the cartodb tiles
      cartodb_imagemaptype = new google.maps.ImageMapType(cartodb_layer);
      carto_map.overlayMapTypes.insertAt(0, cartodb_imagemaptype);
      carto_map.overlayMapTypes.pop(1);
    }

    var cartodb_layer = {
      getTileUrl: function(coord, zoom) {
        var baseURL = "https://johnschimmel.cartodb.com/tiles/dynamicconnections/"+zoom+"/"+coord.x+"/"+coord.y+".png?sql=";
        baseURL += "SELECT *FROM dynamicconnections where is_the_gradient_amenable_to_cycling='yes'&style=";
        baseURL += encodeURI("#dynamicconnections {line-color:#00FFAA;line-width:25;line-opacity:0.35;}");
        return baseURL;
      },
        tileSize: new google.maps.Size(256, 256)
    }

    jQuery(document).ready(function(){

        //Basic
          var cartodbMapOptions = {
            zoom: 12,
            center: new google.maps.LatLng( lat, lng ),
            disableDefaultUI: true,
            mapTypeId: google.maps.MapTypeId.ROADMAP
          }

          // Init the map
          carto_map = new google.maps.Map(document.getElementById("map"),cartodbMapOptions);

        map_style = [ { stylers: [ { saturation: -65 }, { gamma: 1.52 } ] }, { featureType: "administrative", stylers: [ { saturation: -95 },{ gamma: 2.26 } ] }, { featureType: "water", elementType: "labels", stylers: [ { visibility: "off" } ] }, { featureType: "administrative.locality", stylers: [ { visibility: 'on' } ] }, { featureType: "road", stylers: [ { visibility: "simplified" }, { saturation: -99 }, { gamma: 2.22 } ] }, { featureType: "poi", elementType: "labels", stylers: [ { visibility: "off" } ] }, { featureType: "road.arterial", stylers: [ { visibility: 'on' } ] }, { featureType: "road.local", elementType: "labels", stylers: [ { visibility: 'on' } ] }, { featureType: "transit", stylers: [ { visibility: 'off' } ] }, { featureType: "road", elementType: "labels", stylers: [ { visibility: 'on' } ] },{ featureType: "poi", stylers: [ { saturation: -55 } ] } ];

        carto_map.setOptions({styles: map_style});

          // Add the cartodb tiles
          cartodb_imagemaptype = new google.maps.ImageMapType(cartodb_layer);
          carto_map.overlayMapTypes.insertAt(0, cartodb_imagemaptype);

	    jQuery('.buttons button').click(function(){
	      jQuery(this).focus();
	      cat = jQuery(this).val();
	      jQuery(this).closest('div').find('button.selected').removeClass('selected');
	      jQuery(this).addClass('selected');
	      resetLayer();
	    });
    });







</script>

{% endblock %}